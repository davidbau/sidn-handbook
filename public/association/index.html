<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Structure and Interpretation of Deep Networks</title>

<!-- Bootstrap CSS Imports -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

<!-- Google Font Imports -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
rel="stylesheet">

<!-- Custom CSS Imports -->
<link rel="stylesheet" href="/css/style.css">

<!-- Mathjax -->
<script sid="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js" integrity="sha512-6FaAxxHuKuzaGHWnV00ftWqP3luSBRSopnNAA2RvQH1fOfnF/A1wOfiUWF7cLIOFcfb1dEhXwo5VG3DAisocRw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha256-3gQJhtmj7YnV1fmtbVcnAV6eI4ws0Tr48bVZCThtCGQ=" crossorigin="anonymous"></script>

<!-- Auto Table of Contents -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"
/>
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script>

</head>

<body data-bs-spy="scroll" data-bs-target="#toc">
<nav class="navbar navbar-dark bg-dark">
<div class="container-fluid">
<ul class="navbar-nav mr-auto">
 <li class="nav-item active">
  <a class="nav-link" href="/association/index.html">Factual Association</a>
 </li>
</ul>
<ul class="navbar-nav ml-auto">
 <li class="nav-item">
  <a class="navbar-brand" href="/">Structure and Interpretation of Deep Networks</a>
 </li>
</ul>
</div>
</nav>

<div class="container">
<div class="row">
<div class="col-2 position-fixed pt-5">
<nav id="toc" data-toggle="toc"></nav>
</div>
<div class="col-2"></div>
<main class="col-8">
<h1 class="mt-5">Factual Association</h1>


<div><h5>October 15, 2024 â€¢ <em>Achyut Kowshik, Sheridan Feucht</em></h5>

    <p>
If you ask a (decent) LLM to complete the sentence "Coltrane plays the ___", 
it will probably say "tenor" or "saxophone". In order to accurately predict the next word,
the model has to be able to "understand" who John Coltrane is, and then retrieve information on what instrument he plays. 
But how does it do this? Where do LLMs store information about the world, and how do they 
process and retrieve it? These papers on <i>factual assocation</i> try to answer that question. 


<h2>Linear Associative Memory</h2>
<p>
A lot of current work in factual association is indebted to the foundational idea of 
<i>linear associative memory</i>. In <a href="https://rewriting.csail.mit.edu/">one of David's PhD papers</a>, 
they refer to <a href="https://ieeexplore.ieee.org/document/5009138">this 1972 paper</a>
that illustrates how you can use a matrix \( M\) to store pairs of vectors \( (k_i, v_i) \). 
This can approximately done with any kind of matrix.  

\[
v_i \approx Wk_i
\]

But you can actually do this retrieval perfectly if you have orthonormal keys. The way you 
do so is by constructing a matrix that is the sum of the outer products of every desired pair, \(v_ik_i^T \). 
Each one of these outer products is a rank one matrix that we can accumulate to create \( M \),
which has a rank equal to the number of pairs that it is storing. 

<!-- If \( M\) is an \(m\times n\) matrix, then we can store up to \( n \) pairs.  -->

\[
M \mathrel{\mathop:}= \sum_i v_ik_i^T 
\]

David et al. use this insight to edit the convolutional weights of GANs so that they 
obey arbitrary user-defined rules, like making horses wear hats, or trees grow out of church towers.
But what if we can use this to understand fact retrieval in language models? 


<h2>ROME</h2>
<p>
    Achyut: Cover the basics of ROME 

<h3>Does Localization Inform Editing?</h3>
<p>
    A year or so later, some researchers from Google and UNC Chapel Hill wrote a response 
    to David's paper 
    Sheridan todo: https://arxiv.org/abs/2301.04213


<h2>Dissecting Recall of Factual Associations</h2>
<p>
    Achyut: dissecting recall paper 

<h2>Linearity of Relation Decoding</h2>
<p>
    Sheridan: LRE paper 
    Sheridan: mention lrc paper as well 


<h2>Demo</h2>

Todo: make a quick ROME causal tracing (editing?) demo using nnsight


</main>
</div>
</div>
</body>
</html>

